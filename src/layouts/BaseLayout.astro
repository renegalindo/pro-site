---
import { ViewTransitions } from 'astro:transitions';
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';

interface Props {
  title: string;
  description?: string;
}

const {
  title,
  description = 'René Galindo',
} = Astro.props;

const fullTitle = title === 'René Galindo' ? title : `${title} | René Galindo`;
const pageTitle = title === 'René Galindo' ? undefined : title;
---

<!doctype html>
<html lang="en" class="scrollbar-gutter-stable">
  <head>
    <style is:global>
      .scrollbar-gutter-stable {
        scrollbar-gutter: stable;
      }
      /* Firefox */
      html {
        scrollbar-width: thin;
        scrollbar-color: #d1d5db transparent;
      }
      /* WebKit (Chrome, Safari, Edge) */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #d1d5db;
        border-radius: 4px;
      }
      /* GT America Font */
      @font-face {
        font-family: 'GT America';
        src: url('/fonts/GT-America-Standard-Regular.woff2') format('woff2');
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
      @font-face {
        font-family: 'GT America';
        src: url('/fonts/GT-America-Standard-Medium.woff2') format('woff2');
        font-weight: 500;
        font-style: normal;
        font-display: swap;
      }
      /* Minimal link style */
      main a {
        color: inherit;
        text-decoration: underline dotted;
        text-decoration-color: currentColor;
        text-underline-offset: 3px;
        transition: color 0.15s ease, text-decoration-color 0.15s ease;
      }
      main a:hover {
        color: #6b7280;
        text-decoration-color: #6b7280;
      }
      main a:active {
        color: #4b5563;
        text-decoration-color: #4b5563;
      }
      /* Old content disappears instantly, new content fades in */
      ::view-transition-old(main) {
        animation-duration: 0s;
      }
      ::view-transition-new(main) {
        animation-duration: 0.75s;
      }
      /* Page title: old disappears instantly, new fades in with content */
      ::view-transition-old(page-title) {
        animation-duration: 0s; /* Instant disappear */
      }
      ::view-transition-new(page-title) {
        animation-duration: 0.75s; /* Matches content fade-in */
      }
      /* Modal backdrop fade */
      ::view-transition-old(modal-backdrop) {
        animation: fade-out 0.3s ease-out;
      }
      ::view-transition-new(modal-backdrop) {
        animation: fade-in 0.3s ease-out;
      }
      /* Modal card fade + scale */
      ::view-transition-old(modal-card) {
        animation: scale-fade-out 0.3s ease-out;
      }
      ::view-transition-new(modal-card) {
        animation: scale-fade-in 0.3s ease-out;
      }
      /* Fade in with gentle scale up */
      @keyframes scale-fade-in {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      /* Fade out with gentle scale down */
      @keyframes scale-fade-out {
        from {
          opacity: 1;
          transform: scale(1);
        }
        to {
          opacity: 0;
          transform: scale(0.95);
        }
      }
      /* Fade animations */
      @keyframes fade-in {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      @keyframes fade-out {
        from { opacity: 1; }
        to { opacity: 0; }
      }
      /* Prevent body scroll when modal is open */
      body:has(#modal-backdrop) {
        overflow: hidden;
      }
      /* Base font family */
      body {
        font-family: 'GT America', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }
    </style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <title>{fullTitle}</title>
    <meta name="description" content={description} />
    <ViewTransitions />
  </head>
  <body class="bg-gray-50 text-gray-900 antialiased">
    <div class="min-h-screen flex flex-col">
      <Header pageTitle={pageTitle} transition:name="header" transition:persist />
      <main class="flex-1 w-full max-w-2xl mx-auto px-4 pt-4 sm:pt-6 pb-24 text-lg" transition:name="main" transition:animate="fade">
        <slot />
      </main>
      <Footer transition:name="footer" transition:persist />
    </div>
    <!-- Modal slot renders at body level, outside flex container -->
    <slot name="modal" />
  </body>
</html>
