---
import { getCollection } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';

const work = await getCollection('work');
const mainProjects = work.filter(p => !p.data.sideProject).sort((a, b) => a.data.order - b.data.order);
const sideProjects = work.filter(p => p.data.sideProject).sort((a, b) => a.data.order - b.data.order);
---

<BaseLayout title="Work" description="Selected work by RenÃ© Galindo">
  <p class="text-gray-700 mb-8">
    This section can introduce visitors to your professional background and what they'll find in the projects below.
  </p>
  <div class="space-y-2">
    {mainProjects.map((project) => (
      <article class="flex gap-4 -mx-4 px-4 py-3">
        <div class={`w-14 h-14 rounded-xl shrink-0 -ml-px ${project.data.color || 'bg-gray-100'}`}></div>
        <div class="space-y-1">
          <div class="flex items-baseline gap-2">
            <h2 class="font-medium text-gray-900">
              <a
                href={`/work/${project.slug}`}
                class="no-underline hover:underline"
              >
                {project.data.title}
              </a>
            </h2>
            {project.data.year && (
              <span class="text-gray-400">{project.data.year}</span>
            )}
          </div>
          <p class="text-gray-700">
            {project.data.description}
          </p>
        </div>
      </article>
    ))}
  </div>

  <p class="text-gray-700 mt-12 mb-8">
    Side projects I've built over the years.
  </p>
  <div class="space-y-2">
    {sideProjects.map((project) => (
      <article class="flex gap-4 -mx-4 px-4 py-3">
        <div class={`w-14 h-14 rounded-xl shrink-0 -ml-px ${project.data.color || 'bg-gray-100'}`}></div>
        <div class="space-y-1">
          <div class="flex items-baseline gap-2">
            <h2 class="font-medium text-gray-900">
              <a
                href={`/work/${project.slug}`}
                class="no-underline hover:underline"
              >
                {project.data.title}
              </a>
            </h2>
            {project.data.year && (
              <span class="text-gray-400">{project.data.year}</span>
            )}
          </div>
          <p class="text-gray-700">
            {project.data.description}
          </p>
        </div>
      </article>
    ))}
  </div>
</BaseLayout>
